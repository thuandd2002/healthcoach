<?phperror_reporting(E_ERROR);require_once('./export_lib/PHPExcel.php');$objPHPExcel = new PHPExcel();$objPHPExcel->getProperties()->setCreator("Minh Nguyen")        ->setLastModifiedBy("Minh Nguyen")        ->setTitle("Danh sach")        ->setSubject("Danh sach khach hang");$objPHPExcel->setActiveSheetIndex(0)    ->setCellValue("A1", "STT")    ->setCellValue("B1", "Họ tên")    ->setCellValue("C1", "Email")    ->setCellValue("D1", "Phone")    ->setCellValue("E1", "Ngày")    ->setCellValue("F1", "Giờ")	->setCellValue("G1", "Nội dung")	;$objPHPExcel->getActiveSheet()->getStyle('A1:M1')->getFont()->setBold(true);$strWhere = " 1=1 ";$keyword = $_REQUEST["keyword"];$formname = $_REQUEST["contact_type"];if ($formname != "") {	$strWhere .= " AND formname = '$formname' ";}$startdate = $_REQUEST["startdate"];if ($startdate != "") {	$fromdate = string_to_microtime($startdate);	$strWhere .= " AND createdate >= $fromdate ";}$enddate = $_REQUEST["enddate"];if ($enddate != "") {	$todate = string_to_microtime($enddate . " 23:59:59");		$strWhere .= " AND createdate <= $todate ";}$sql = "SELECT  * FROM contact WHERE $strWhere ORDER BY id_contact DESC";echo $sql; $result= $mysqli->query($sql);$i=1;while ($row=mysqli_fetch_array($result,MYSQLI_ASSOC)){        $i++;    $objPHPExcel->setActiveSheetIndex(0)                ->setCellValue("A$i", $i )        ->setCellValue("B$i", $row[name])        ->setCellValue("C$i", $row[email])        ->setCellValue("D$i", $row[phone])        ->setCellValue("E$i", date("d/M/y", $row[createdate] ) )        ->setCellValue("F$i", date("H:i", $row[createdate] ) )		->setCellValue("G$i", $row[content])        ;        }$result->close();$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(8);$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(20);$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setWidth(15);$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setWidth(30);$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setWidth(10);$objPHPExcel->getActiveSheet()->getColumnDimension('F')->setWidth(25);$objPHPExcel->getActiveSheet()->getColumnDimension('F')->setWidth(50);// Set active sheet index to the first sheet, so Excel opens this as the first sheet$objPHPExcel->setActiveSheetIndex(0);$file_name = "danhsach-". date("d-m-Y--H-i", time() );//$fileExcel ="/uploaded/files/$file_name.xlsx";$fileExcel ="/uploaded/files/$file_name.xlsx";$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');$objWriter->save($_SERVER["DOCUMENT_ROOT"]. $fileExcel);echo date('H:i:s') , " - File created !!, please  <a href='$fileExcel'> click here  </a> to download...";?>